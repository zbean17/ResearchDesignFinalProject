---
title: "FinalProjectRD"
author: "Zoe Bean"
date: "11/18/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


```{r import}

make_data<-read_csv("Group+Projects+2021_all_numeric.csv", col_select = c(Q13.1,Q13.2,Q13.3,Q14.1,Q14.2,Q14.3,Q15.1,Q15.2,Q15.3,Q16.1_1,Q16.1_2,	Q16.1_3,Q16.1_4)) #selects only our question columns
make_data<-make_data[-c(1:2),] #remove rows not number data
write_csv(make_data, "media_data.csv") #make new dataset csv

remove(make_data) #remove extra dataset
media_data<-read_csv("media_data.csv") #now open csv so that all variables register as numbers and not characters

```

```{r newcolumn}
# adjust reverse scored questions
media_data<-media_data %>% mutate(Q16.1_2= case_when( Q16.1_2==5~1, Q16.1_2==4~2, Q16.1_2==2~4,Q16.1_2==3~3,  Q16.1_2==1~5), Q16.1_3= case_when( Q16.1_3==5~1, Q16.1_3==4~2,Q16.1_3==3~3, Q16.1_3==2~4, Q16.1_3==1~5))

#add new columns
media_data<-media_data %>% 
  mutate(mood= case_when( 
    !is.na(Q13.1) | !is.na(Q13.2) | !is.na(Q13.3) ~ 'neutral', #if 13.1, 13.2, 13.3 have answer post mood= neutral
    !is.na(Q14.1) | !is.na(Q14.2 | !is.na(Q14.3))  ~ 'stress', #if 14.1, 14.2, 14.3 have answer post mood= stress
    !is.na(Q15.1) | !is.na(Q15.2) | !is.na(Q15.3) ~ 'happy' ),#if 359, 360, 361 have answer post mood= happy
    
    score= Q16.1_1+Q16.1_2+Q16.1_3+Q16.1_4) #the score of the stress scale 

media_data <- filter(media_data, rowSums(is.na(media_data)) != ncol(media_data)) #removing the rows that are all NAs
```


```{r analysis}
ggplot(data=media_data, aes(score)) +
  geom_bar() + facet_wrap(~mood)

ggplot(data = media_data, mapping = aes(x = mood, y = score)) +
    geom_boxplot()

media_data%>%group_by(mood)%>%summarize(mean(score), median(score), min(score), max(score))
```